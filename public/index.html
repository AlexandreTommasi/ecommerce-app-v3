<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-commerce App v3 - Pool 3</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #6B73FF 0%, #000DFF 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        h1 { color: #333; margin-bottom: 15px; font-size: 2.5rem; }
        .pool-badge { display: inline-block; background: #6B73FF; color: white; padding: 5px 15px; border-radius: 20px; font-size: 14px; margin-left: 10px; }
        .status { display: flex; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .status-item { padding: 10px 20px; background: #f5f5f5; border-radius: 8px; font-weight: 500; }
        .status-item.online { background: linear-gradient(135deg, #00d2ff, #3a7bd5); color: white; }
        .status-item.offline { background: linear-gradient(135deg, #ff512f, #dd2476); color: white; }
        .produtos-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; margin-top: 30px; }
        .produto-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); transition: transform 0.3s; }
        .produto-card:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.15); }
        .produto-card h3 { color: #333; margin-bottom: 10px; font-size: 1.3rem; }
        .produto-card .categoria { display: inline-block; background: #e3f2fd; color: #1976d2; padding: 3px 10px; border-radius: 12px; font-size: 12px; margin-bottom: 10px; }
        .produto-card .preco { font-size: 28px; color: #00d2ff; font-weight: bold; margin: 10px 0; }
        .produto-card .estoque { color: #666; margin-top: 10px; font-size: 14px; }
        .add-produto { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; font-size: 14px; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #6B73FF; }
        .btn { background: linear-gradient(135deg, #6B73FF, #000DFF); color: white; border: none; padding: 14px 35px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
        .btn:hover { transform: scale(1.05); }
        .empty-state { text-align: center; padding: 60px 20px; color: white; }
        .empty-state h2 { font-size: 2rem; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ›’ E-commerce App <span class="pool-badge">Pool 3</span></h1>
            <div class="status">
                <div class="status-item" id="appStatus">App: Verificando...</div>
                <div class="status-item" id="dbStatus">Database: Verificando...</div>
                <div class="status-item" id="poolStatus">Pool: expandev-pool-3</div>
            </div>
        </header>

        <div class="add-produto">
            <h2>âž• Adicionar Novo Produto</h2>
            <form id="produtoForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nome do Produto</label>
                        <input type="text" id="nome" required placeholder="Ex: Notebook Dell">
                    </div>
                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="categoria" required>
                            <option value="">Selecione...</option>
                            <option value="EletrÃ´nicos">EletrÃ´nicos</option>
                            <option value="InformÃ¡tica">InformÃ¡tica</option>
                            <option value="MÃ³veis">MÃ³veis</option>
                            <option value="Livros">Livros</option>
                            <option value="Esportes">Esportes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>PreÃ§o (R$)</label>
                        <input type="number" id="preco" step="0.01" required placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Estoque</label>
                        <input type="number" id="estoque" required placeholder="0">
                    </div>
                </div>
                <button type="submit" class="btn">Adicionar Produto</button>
            </form>
        </div>

        <div id="produtosContainer">
            <div class="produtos-grid" id="produtos"></div>
        </div>
    </div>

    <script>
        async function checkStatus() {
            try {
                const response = await fetch('/api/status');
                const data = await response.json();
                document.getElementById('appStatus').textContent = 'App: Online';
                document.getElementById('appStatus').className = 'status-item online';
                document.getElementById('dbStatus').textContent = `Database: ${data.database}`;
                document.getElementById('dbStatus').className = `status-item ${data.database === 'conectado' ? 'online' : 'offline'}`;
            } catch (error) {
                document.getElementById('appStatus').textContent = 'App: Offline';
                document.getElementById('appStatus').className = 'status-item offline';
            }
        }

        async function loadProdutos() {
            try {
                const response = await fetch('/api/produtos');
                const produtos = await response.json();
                const container = document.getElementById('produtos');
                
                if (produtos.length === 0) {
                    document.getElementById('produtosContainer').innerHTML = `
                        <div class="empty-state">
                            <h2>ðŸ“¦ Nenhum produto cadastrado</h2>
                            <p>Adicione seu primeiro produto usando o formulÃ¡rio acima!</p>
                        </div>
                    `;
                } else {
                    container.innerHTML = produtos.map(p => `
                        <div class="produto-card">
                            <span class="categoria">${p.categoria || 'Sem categoria'}</span>
                            <h3>${p.nome}</h3>
                            <div class="preco">R$ ${p.preco.toFixed(2)}</div>
                            <div class="estoque">ðŸ“¦ ${p.estoque} unidades em estoque</div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Erro ao carregar produtos:', error);
            }
        }

        document.getElementById('produtoForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const produto = {
                nome: document.getElementById('nome').value,
                categoria: document.getElementById('categoria').value,
                preco: parseFloat(document.getElementById('preco').value),
                estoque: parseInt(document.getElementById('estoque').value)
            };
            
            try {
                const response = await fetch('/api/produtos', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(produto)
                });
                
                if (response.ok) {
                    document.getElementById('produtoForm').reset();
                    loadProdutos();
                }
            } catch (error) {
                console.error('Erro ao adicionar produto:', error);
            }
        });

        checkStatus();
        loadProdutos();
        setInterval(checkStatus, 5000);
    </script>
</body>
</html>